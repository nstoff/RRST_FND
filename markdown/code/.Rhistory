# SIMPLE CORRELATION OF INTEROCEPTIVE VARIABLES WITH SYMPTOM SEVERITY (that we have for both groups; SDQ)
cor.test(df$rrst_sensitivity, df$sdq, method = "pearson") # pearson for normally distributed data
#| output: false
#| warning: FALSE
#| error: FALSE
# remove everything that we stored in the environment
rm(list=ls())
# Load necessary libraries
library(readr)
library(dplyr)
library(rstatix)
library(gtsummary)
library(ggplot2)
library(ggpubr)
library(openxlsx)
library(gt)
library(stats)
library(grDevices)
library(car)
library(stringr)
library(lubridate)
library(Hmisc)
### 0.0 PREPARATION -----------------------------------------------------------
# load prepared and cleaned file from 00_preparation: df_yyyymmdd.csv
setwd("/Users/nataschastoffel/Documents/GitHub/interoception_NS")
df_RRST <- read_csv("/Users/nataschastoffel/Documents/GitHub/interoception_NS/data/processed/11-2024/Data.RRST_FINAL_20241120.csv")
df <- df_RRST[-c(1)] # remove additional column
# excluded_pcodes <- c(14)  # pcodes that we want to exclude due to our exclusion criteria (that they were not able to perform the task adequetely; due to not understanding/performing with a 0.0000 sensitivity)
# Filter out the rows with the specified pcodes
# df <- df %>% filter(!pcode %in% excluded_pcodes)
#Set path for output files; working directory to the correct folder
setwd("~/Documents/GitHub/interoception_NS/output/RRST/11-2024")
df <- df %>%
mutate(anx_dep_SUM = stai_t + bdi)# create one variable for the trait anxiety and depression to use as one variable in the model
# factor variables
factor_variables <- c('group', 'sex', 'psychotropic_medication', 'menopause', 'contraception')
# Apply as.numeric to the selected columns
df[factor_variables] <- lapply(df[factor_variables], as.factor)
# numeric variables
numeric_variables <- c('age', 'bmi', 'bdi', 'stai_s', 'stai_t', 'maia_total', 'anx_dep_SUM',
'sdq', 'ctq_total', 'ias', 'rrst_sensitivity',
'traitPE_maiaRRST', 'traitPE_iasRRST', 'metascore')
# Apply as.numeric to the selected columns
df[numeric_variables] <- lapply(df[numeric_variables], as.numeric)
# define required subgroups
df_female <- df[df$sex == "1", ]
df_male <- df[df$sex == "2", ]
df_HC <- df[df$group == "0", ]
df_FND <- df[df$group == "1", ]
# Testing Outlier using boxplot (standard deviation)
df %>%
group_by(group) %>%
identify_outliers(rrst_sensitivity)
# one outlier identified = P063 for rrst_sensitivity
#### Box-Plot with Jitter
plotBoxplotGroups <- function(df, var , tit ){
plot <- ggplot(df, aes(x = group, y = var, fill = group)) +
geom_boxplot(show.legend = TRUE) + # Show legend for boxplot
labs(y = "Score") +
theme_classic() +
scale_fill_manual(values = c("#868686FF", "#BB4038")) +
scale_x_discrete(labels = c("HC", "FND")) +
guides(fill = "none") + # Remove the legend
ggtitle(tit) +
xlab("") +
geom_jitter(shape = 16, position = position_jitter(0.2))
return(plot)
}
p1 <- plotBoxplotGroups(df, (df$rrst_sensitivity), "Respiration Sensitivity") +
stat_compare_means(method = "t.test", paired = FALSE, label.x = 1.3)
p1
# Filter the rows where rrst_sensitivity is greater than 8 and display pcode (visually detected as extreme)
filtered_pcodes <- df[df$rrst_sensitivity > 8, "pcode"]
print(filtered_pcodes)
# P063
# Calculate mean and standard deviation of rrst_sensitivity
mean_rrst <- mean(df$rrst_sensitivity)
sd_rrst <- sd(df$rrst_sensitivity)
# Define the threshold for filtering (mean + 2.5 * SD)
threshold <- mean_rrst + 2.5 * sd_rrst # 7.07
# Filter the pcodes for rrst_sensitivity greater than the threshold
filtered_pcodes <- df[df$rrst_sensitivity > threshold, "pcode"]
# View the result
filtered_pcodes
# P063
# Testing the Assumptions in the main model (rrst sensitivity predicted by clinical variables)
# model:
lmrrst <- lm(
rrst_sensitivity ~ group + sex + bmi + psychotropic_medication + anx_dep_SUM + ctq_total + sdq,
data = df)
# testing assumptions
plot(lmrrst, which=1) # testing the assumptions of Linearity and Homoscedasticity with residuals vs fitted plot: the line should more or less be straight: observation 56 is a clear outlier
plot(lmrrst, which=2) # testing the assumptions normality of residuals with  standardized quantiles: the data points should more or less on the line: observation 56 is a clear outlier (not as extreme but also noted: 81, 65)
plot(lmrrst, which=3) # testing the assumption of homoscedasticity with scale-location plot--> if there is an incline then we should consider log transformation: observation 56 is a clear outlier (not as extreme but also noted: 81, 65)
plot(lmrrst, which=5) # testing leverage and influence = when an outlier has a lot of leverage over the regression line (high leverage & large residual; these points will lie close to the right top or bottom corners): observation 56 is a clear outlier (not as extreme but also noted: 81, 6)
# observation 56 (consistent outlier) = P063
df_exclusion <- df[df$pcode != "63", ]
p1b <- plotBoxplotGroups(df_exclusion, (df_exclusion$rrst_sensitivity), "Respiration Sensitivity") +
stat_compare_means(method = "t.test", paired = FALSE, label.x = 1.3)
print(p1b)
p1b
# Summary of Change - depending on Exclusion of Outlier
summary(df$rrst_sensitivity)  # no sig difference between group (cut of 0.05)
summary(df_exclusion$rrst_sensitivity) # sig difference between group (cut of 0.05)
# for statistical reasons we EXCLUDE P063 from the dataset
df <- df[df$pcode != "63", ]
#| warning: FALSE
#| error: FALSE
# overview across group and sex distribution
tbl <- df %>%
mutate(sex = factor(sex, levels = c("1", "2"), labels = c("female", "male"))) %>%
mutate(group = factor(group, levels = c("0", "1"), labels = c("HC", "FND")))
tbl1<-table(tbl$group,tbl$sex)
tbl1
# overview for mean age across group
summary_stats <- tbl %>%
group_by(group) %>%
get_summary_stats(age, type = "full") # 'full' includes mean, SD, min, max, etc.
print(summary_stats)
res<-t.test(df$age[df$group == "0"], df$age[df$group == "1"]) #
res # no sig difference between the groups in age
# SUMMARY TABLE DEMOGRAPHICS -----
df_tbl <- df %>%
mutate(sex = factor(sex, levels = c("1", "2"), labels = c("male", "female"))) %>%
mutate(group = factor(group, levels = c("0", "1"), labels = c("HC", "FND"))) %>%
mutate(psychotropic_medication = factor(psychotropic_medication, levels = c("0", "1"), labels = c("no", "yes")))
library(gtsummary)
library(dplyr)
# Select relevant columns from df_tbl
Data.t <- select(df_tbl, c("group", "sex", "age", "psychotropic_medication", "smoke_crf", "bmi", "bdi", "stai_t", "ctq_total", "sdq"))
# Create the summary table
tbl1 <- Data.t %>%
tbl_summary(
by = group,
missing = "no",
statistic = list(
age = "{mean} ({sd})",
sex = "{n} ({p})",
psychotropic_medication = "{n} ({p})",
smoke_crf = "{n} ({p})",
bmi = "{median} ({p25}, {p75})",
bdi = "{median} ({p25}, {p75})",
stai_t = "{mean} ({sd})",
ctq_total = "{median} ({p25}, {p75})",
sdq = "{median} ({p25}, {p75})"
),
digits = list(age = 1, sex = 1, psychotropic_medication = 1, smoke = 1, bmi = 1, bdi = 1, stai_t=1, ctq_total=1, sdq=1),
label = list(age = "Age, mean (SD)",
sex = "Sex, count (%)",
psychotropic_medication= "Intake of psychotropic Medication, count (%)",
smoke_crf = "Smoking, count (%)",
bmi = "Body Mass Index kg/mÂ², median (IQR)",
bdi = "Depression using BDI-II, median (IQR), ",
stai_t = "Trait Anxiety using STAI, median (IQR)",
ctq_total = "Childhood Trauma, using CTQ total, median (IQR)",
sdq = "Dissociation using SDQ-20, median (IQR)")
) %>%
modify_header(list(label ~ "**Variable**")) %>%
modify_caption("**Demographics Overview**") %>%
modify_spanning_header(c("stat_1", "stat_2") ~ "**Group**") %>%
add_p( test = list(
age ~ "t.test",            # t-test for numeric variables (even though NOT normally distributed; rather use wilcox and then the median instead of the mean??)
bmi ~ "wilcox.test",            # t-test for bmi
sex ~ "chisq.test",        # chi-square test for factor variables
psychotropic_medication ~ "chisq.test",  # Fisher's exact test for small samples
smoke_crf ~ "chisq.test",  # Fisher's exact test for small samples
bdi ~ "wilcox.test",
stai_t ~ "t.test",
ctq_total = "wilcox.test",
sdq="wilcox.test"
)) %>%
add_overall(last = FALSE)
# Display the table
tbl1
# SIMPLE CORRELATION OF INTEROCEPTIVE VARIABLES WITH SYMPTOM SEVERITY (that we have for both groups; SDQ)
cor.test(df$rrst_sensitivity, df$sdq, method = "pearson") # pearson for normally distributed data
cor.test(df$metascore, df$sdq, method = "spearman") # metascore: not normally distributed thsu spearman
cor.test
cor.test(df$metascore, df$sdq, method = "spearman") # metascore: not normally distributed thsu spearman
# SIMPLE CORRELATION OF INTEROCEPTIVE VARIABLES WITH SYMPTOM SEVERITY (that we have for both groups; SDQ)
cor.test(df$rrst_sensitivity, df$sdq, method = "pearson") # pearson for normally distributed data
cor.test # p-value = 0.0002628,  cor = -0.3737694
cor.test(df$metascore, df$sdq, method = "spearman") # metascore: not normally distributed thsu spearman
cor.test(df$traitPE_iasRRST, df$sdq, method = "pearson") # pearson for normally distributed data
cor.test(df$traitPE_iasRRST, df$sdq, method = "spearman") # metascore: not normally distributed thsu spearman
cor.test(df$metascore, df$sdq, method = "pearson") # metascore: not normally distributed thsu spearman
cor.test(df$traitPE_iasRRST, df$sdq, method = "pearson")
cor.test(df$traitPE_maiaRRST, df$sdq, method = "pearson")
# FND only
cor.test(df_FND$rrst_sensitivity, df_FND$sfmdrs, method = "pearson")
cor.test(df_FND$metascore, df_FND$sfmdrs, method = "pearson")
cor.test(df_FND$traitPE_iasRRST, df_FND$sfmdrs, method = "pearson")
cor.test(df_FND$traitPE_maiaRRST, df_FND$sfmdrs, method = "pearson")
#SDQ (full sample)
sdq_lm <- lm(formula = sdq ~  rrst_sensitivity + sex + group,
data = df)
summary(sdq_lm)  # p= 0.069 for metascore
sdq_lm <- lm(formula = sdq ~  rrst_sensitivity + sex + group + anx_dep_SUM,
data = df)
summary(sdq_lm)  # RRST sensitivty and GROUP
sdq_lm <- lm(formula = sdq ~  rrst_sensitivity + sex + group + anx_dep_SUM + psychotropic_med,
data = df)
sdq_lm <- lm(formula = sdq ~  rrst_sensitivity + sex + group + anx_dep_SUM + psychotropic_medication,
data = df)
summary(sdq_lm)  # RRST sensitivty and GROUP and ANX_DEP
### PATIENTS ONLY
#SFMDRS
sfmdrslm <- lm(formula = sfmdrs ~  rrst_sensitivity + sex + group,
data = df_FND)
summary(sfmdrslm)   # no sig association
### PATIENTS ONLY
#SFMDRS
sfmdrslm <- lm(formula = sfmdrs ~  rrst_sensitivity + sex + group,
data = df_FND)
### PATIENTS ONLY
#SFMDRS
sfmdrslm <- lm(formula = sfmdrs ~  rrst_sensitivity + sex,
data = df_FND)
summary(sfmdrslm)   # no sig association
sfmdrslm <- lm(formula = sfmdrs ~  rrst_sensitivity + sex + anx_dep_SUM ,
data = df_FND)
summary(sfmdrslm)   # no sig association
sfmdrslm <- lm(formula = sfmdrs ~  rrst_sensitivity + sex + anx_dep_SUM + psychotropic_medication,
data = df_FND)
summary(sfmdrslm)   # no sig association
#CGI
cgilm <- lm(formula = cgi ~  rrst_sensitivity + sex,
data = df_FND)
summary(cgilm) # no sig assocaition
#Sum score pos signs  (pos signs like wekaness in deltoid/stenocleido etc, co-contractions, give way weakness, hoover, hyposensitivity)
sum_pos_lm <- lm(formula = rrst_sensitivity + sex,
data = df_FND)
#Sum score pos signs  (pos signs like wekaness in deltoid/stenocleido etc, co-contractions, give way weakness, hoover, hyposensitivity)
sum_pos_lm <- lm(formula = sum_positive_signs ~  rrst_sensitivity + sex,
data = df_FND)
summary(sum_pos_lm)   # p=0.0556 for rrst_sensitivity
#Sum score severity (motor weakness and seizure frequency)
sum_pos_lm <- lm(formula = sum_severity ~  rrst_sensitivity + sex,
data = df_FND)
summary(sum_pos_lm)  # p= 0.069 for metascore
#| warning: FALSE
#| error: FALSE
#SDQ
sdq_lm <- lm(formula = sdq ~  rrst_sensitivity + sex + group,
data = df)
summary(sdq_lm)  # RRST sensitivity and GROUP
#| warning: FALSE
#| error: FALSE
#SDQ
sdq_lm <- lm(formula = sdq ~  rrst_sensitivity + group + sex + age,
data = df)
summary(sdq_lm)  # RRST sensitivity and GROUP
#SDQ
sdq_lm <- lm(formula = sdq ~  metascore + group + sex,
data = df)
summary(sdq_lm)  #  metascore and GROUP
sdq_lm <- lm(formula = sdq ~  metascore + sex + group + anx_dep_SUM,
data = df)
summary(sdq_lm)  #  metascore and GROUP and ANX_DEP ; meaning this assocaition is not due to the differences in affective symptoms
sdq_lm <- lm(formula = sdq ~  metascore + sex + group + anx_dep_SUM + psychotropic_medication,
data = df)
summary(sdq_lm)  #  metascore and GROUP and ANX_DEP ; meaning these assocaition are not due to the difference of psychotropic medication
#SFMDRS
sfmdrslm <- lm(formula = sfmdrs ~  metascore + sex,
data = df_FND)
summary(sfmdrslm)   # no sig association
#CGI
cgilm <- lm(formula = cgi ~  metascore + sex,
data = df_FND)
summary(cgilm) # no sig association
#Sum score pos signs
sum_pos_lm <- lm(formula = sum_positive_signs ~  metascore + sex,
data = df_FND)
summary(sum_pos_lm)   # no sig assocaition
#Sum score severity
sum_pos_lm <- lm(formula = sum_severity ~  metascore + sex,
data = df_FND)
summary(sum_pos_lm)  # no sig assocaition
# predciting rrst sensitvity with covariates
lm<-lm(rrst_sensitivity ~ group + sex + psychotropic_medication + anx_dep_SUM,
data = df)
summary(lm) # SEX, MEDICATION, CTQ and SDQ sig associated with RRST-sensitivity
# predciting rrst sensitvity with covariates
lm<-lm(rrst_sensitivity ~ group + sex + psychotropic_medication + anx_dep_SUM + ctq_total,
data = df)
summary(lm) # SEX, MEDICATION, CTQ and SDQ sig associated with RRST-sensitivity
# predciting rrst sensitvity with covariates
lm<-lm(rrst_sensitivity ~ group + sex + psychotropic_medication + anx_dep_SUM,
data = df)
summary(lm) # SEX, MEDICATION, CTQ and SDQ sig associated with RRST-sensitivity
# RRST sensitivity and separate CTQ subscores
lmrrst <- lm(
rrst_sensitivity ~ group + ctq_physab + ctq_emoab + ctq_sexab + ctq_emoneg + ctq_physneg,
data = df)
summary(lmrrst)  # no subscale in intself associated with RRST
# predciting  rrst metascore with covariates
lm<-lm(metascore ~ group + sex + psychotropic_medication + anx_dep_SUM + ctq_total + sdq,
data = df)
# predciting  rrst metascore with covariates
lm<-lm(metascore ~ group + sex + psychotropic_medication + anx_dep_SUM,
data = df)
summary(lm) #  SDQ and CTQ sig associated with METASCORE
# predciting  traitPE uing RRST and MAIA with covariates
lm<-lm(traitPE_maiaRRST ~ group + sex + psychotropic_medication + anx_dep_SUM,
data = df)
summary(lm) #  SEX, MEDICATION and ANX-DEP sum score sig associated with traitPE-maia
# predciting  traitPE uing RRST and MAIA with covariates
lm<-lm(traitPE_iasRRST ~ group + sex + psychotropic_medication + anx_dep_SUM,
data = df)
summary(lm) #  MEDICATION sig associated with traitPE-ias
# predciting  rrst metascore with covariates
lm<-lm(metascore ~ group + sex + psychotropic_medication + anx_dep_SUM,
data = df)
summary(lm) #  SDQ and CTQ sig associated with METASCORE
# predciting rrst sensitvity with covariates
lm<-lm(rrst_sensitivity ~ group + sex + psychotropic_medication + anx_dep_SUM,
data = df)
summary(lm) # MEDICATION sig associated with RRST-sensitivity
# calculation of cohens d for variable of interest
# Define the function
calculate_cohens_d <- function(data, variable, group_var, group1, group2) {
# Subset the data for each group
group1_data <- data[[variable]][data[[group_var]] == group1]
group2_data <- data[[variable]][data[[group_var]] == group2]
# Calculate means and standard deviations
mean1 <- mean(group1_data, na.rm = TRUE)
mean2 <- mean(group2_data, na.rm = TRUE)
sd1 <- sd(group1_data, na.rm = TRUE)
sd2 <- sd(group2_data, na.rm = TRUE)
# Calculate sample sizes
n1 <- sum(!is.na(group1_data))
n2 <- sum(!is.na(group2_data))
# Calculate pooled standard deviation
sd_pooled <- sqrt(((n1 - 1) * sd1^2 + (n2 - 1) * sd2^2) / (n1 + n2 - 2))
# Calculate Cohen's d
cohens_d <- (mean1 - mean2) / sd_pooled
# Return Cohen's d
return(cohens_d)
}
cohens_d_maia <- calculate_cohens_d(df, "maia_total", "group", 1, 0) # group 1=FND, group=0 HC
print(cohens_d_maia) # cohens d of -0.786 means with an effect size of 0.786 FND has LOWER values than HC
cohens_d_ias <- calculate_cohens_d(df, "ias", "group", 1, 0) # group 1=FND, group=0 HC
print(cohens_d_ias) # cohens d of -0.651 means with an effect size of 0.651 FND has LOWER values than HC
cohens_d_bmi <- calculate_cohens_d(df, "bmi", "group", 1, 0) # group 1=FND, group=0 HC
print(cohens_d_bmi) # cohens d of -0.651 means with an effect size of 0.651 FND has LOWER values than HC
cohens_d_bmi <- calculate_cohens_d(df, "psychotropic_medication", "group", 1, 0) # group 1=FND, group=0 HC
